:lang: ru-RU
:source-highlighter: rouge

= 1.1 Интерпретация. Виды интерпретаторов. Компоненты итеративного интерпретатора.


== Интерпретация
#Интерпретация# – это механизм непосредственного исполнения отдельных
языковых элементов (строк, лексем, команд) программ

Исходный текст высокоуровневых программ на ВМ компилируется (мб неявной динамической) в промежуточное представление (#ПП#)

#Форматы кода#

* Распространяемый формат 
** Стандартизован
** Машинно-независим
** Расширяем
** Компактен
** Пример: `.jar` файлы `Java` (архивы с бинарными class файлами)
** Может содержать медиа ресурсы
* Выполняемый формат -- представление кода в памяти VM
** Порождается из распространяемого формата после его конверсии: загрузки, линковки и верификации
** Может дополнять или замещать распространяемый 
** Преобразования мб статически (отдельная стадия) или динамически (в рантайм)
** Преобразование производится не обязательно локально

== Виды интерпретаторов
[cols="1,2,2"]
|===
|Интерпретатор
|Рекурсивный
|Итеративный


|Выполнение
|Обходит код, рекурсивно вызывая себя
|Перебирает инструкции последовательно в цикле

|Вызов подпрограммы
|вызывает себя c подпрограммой и параметрами её вызова
| формирует новую секцию в стеке вызовов, меняет указатель текущей инструкции, продолжает выполнение цикла

|Параметры и результаты передаются…
|… непосредственно при вызове 
|… в виртуальных регистрах или на стеке операндов

|Применяется для ПП в виде…
|…текста, деревьев или графа
|…потока, последовательности или массива инструкций (линейных кодов)
|===

== Компоненты итеративного интерпретатора

* Набор инструкций
** add, load, branch... (может быть расширяемым)
* Виртуальные регистры
** ip — адрес текущей инструкции
** sp — указатель стека
** fp — адрес текущей рамки стека вызовов
* Стеки
** Стек вызовов для организации вызовов
подпрограмм, обычно состоит из
рамок/секций/записей активации
** Стек операндов для передачи параметров и выдачи
результатов виртуальных инструкций (может быть
частью стека вызовов или вообще отсутствовать)
* Цикл интерпретатора
** декодер инструкций и их реализация
